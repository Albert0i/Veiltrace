<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Veiltrace View</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <script src="/assets/tailwind.js"></script>
  </head>
  <body class="bg-gray-50 text-gray-900">

    <div class="max-w-7xl mx-auto pt-6 pb-2 px-6">
      <!-- Header -->
      <header class="mb-4 text-center">
        <h1 class="text-3xl font-serif font-semibold tracking-tight">Veiltrace Image</h1>
      </header>
  
      <!-- Main Content -->
      <main class="max-w-3xl mx-auto px-4 py-0 space-y-2">
  
        <!-- Image Display -->
        <section class="text-center">
          <img src="/api/v1/image/view/<%= id %>" alt="Veiltrace Image" class="rounded-lg shadow max-w-full h-auto mx-auto">

          <!-- Download Button -->
          <div class="mt-4 mb-6">
            <a href="/api/v1/image/view/<%= id %>" download="<%= imageName %>" class="inline-block px-4 py-1 text-sm bg-gray-700 text-white rounded hover:bg-gray-800 transition">
              Download
            </a>
          </div>
        </section>

        <!-- Metadata -->
        <section class="bg-white rounded-lg shadow p-2 space-y-1 text-md">
          <h2 class="text-lg font-semibold text-black mb-2">Image Details</h2>

          <div><span class="font-medium text-gray-900">Name:</span> <%= imageName %></div>
          <div><span class="font-medium text-gray-900">Format:</span> <%= fileFormat %></div>
          <div><span class="font-medium text-gray-900">Size:</span> <%= fileSize %> KB</div>
          <div><span class="font-medium text-gray-900">Path:</span> <%= fullPath %></div>

          <div><span class="font-medium text-gray-900">Meta:</span> <br /><%- meta.replace(/\n/g, "<br />")
            %></div>
          <div><span class="font-medium text-gray-900">Description:</span> <br /><%- description.replace(/\n/g, "<br />")
            %></div>

          <div><span class="font-medium text-gray-900">Visited:</span> <%= visited %></div>
          <div><span class="font-medium text-gray-900">Updated At:</span> <%= updatedAt || '—' %></div>
          <div><span class="font-medium text-gray-900">Indexed At:</span> <%= indexedAt %></div>
          <div><span class="font-medium text-gray-900">Created At:</span> <%= createdAt %></div>

        </section>
  
        <!-- Vistas -->
        <section class="bg-white rounded-lg shadow p-2 space-y-1 text-sm">
          <h2 class="text-lg font-semibold text-black mb-2">Vista Details</h2>

          <ul class="list-none space-y-1 text-sm text-gray-900">
            <% vistas.forEach((vista, index) => { %>
              <li>
                <strong>
                  <%= vistas.length - index %>
                </strong> . 
                <%= vista.type.charAt(0).toUpperCase() + vista.type.slice(1) %> — <%= vista.createdAt %>
              </li>
            <% }) %>
          </ul>
        </section>
  
      </main>
    </div>

    <!-- Close Button -->
    <!-- <div class="text-center m-4">
      <a href="/" class="inline-block px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">
        Close
      </a>
    </div> -->
    <div class="flex justify-center items-center h-12">
      <button onclick="window.close()"
              class="inline-block px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition cursor-pointer">
        Close
      </button>
    </div>

    <!-- Copilot Credit -->
    <footer class="m-4 text-center text-sm text-gray-700">
        <p>
        Crafted in quiet partnership with  
        <a href="https://copilot.microsoft.com" target="_blank" class="text-blue-600 font-semibold hover:underline">
            Microsoft Copilot
        </a> — <br />your poetic companion in code, ritual, and breath. Veiltrace. All traces remembered.
        </p>
    </footer>

  </body>
</html>