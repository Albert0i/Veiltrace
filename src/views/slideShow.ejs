<!DOCTYPE html>
<html lang="en">
<head>
  <title><%= title %> â€” Slideshow</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script src="/assets/tailwind.js"></script>
</head>
<body class="m-0 bg-black overflow-hidden relative">

  <!-- Slideshow image -->
  <img id="slideshow-image"
       src=""
       alt="Slideshow Image"
       class="block mx-auto max-w-screen max-h-screen transition-opacity duration-500 ease-in-out"
       title="[Space Bar]=Pause    [Left/Right Arrow]=Move backward/forward    [Esc]=Quit" />

  <script type="text/javascript">
    const imageIds = <%= JSON.stringify(imageIds) %>;
    const baseUrl = '/api/v1/image/view/';
    const images = imageIds.map(id => `${baseUrl}${id}`);

    let index = 0;
    let paused = false;
    let interval = <%= interval %>;
    let timer;

    const img = document.getElementById('slideshow-image');

    function showImage() {
      img.classList.add('opacity-0');
      setTimeout(() => {
        img.src = images[index];
        img.classList.remove('opacity-0');
      }, 100);
    }

    function nextImage() {
      index = (index + 1) % images.length;
      showImage();
    }

    function prevImage() {
      index = (index - 1 + images.length) % images.length;
      showImage();
    }

    function startLoop() {
      timer = setInterval(() => {
        if (!paused) nextImage();
      }, interval);
    }

    function stopLoop() {
      clearInterval(timer);
    }

    document.addEventListener('keydown', (e) => {
      switch (e.key) {
        case ' ': paused = !paused; break;
        case 'Escape': window.close(); break;
        case 'ArrowRight': nextImage(); break;
        case 'ArrowLeft': prevImage(); break;
      }
    });

    showImage();
    startLoop();
  </script>
</body>
</html>