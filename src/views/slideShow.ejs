<!DOCTYPE html>
<html>
<head>
  <title><%= title %> â€” Slideshow</title>
  <style>
    body { margin: 0; background: black; overflow: hidden; }
    img { display: block; margin: auto; max-width: 100vw; max-height: 100vh; transition: opacity 0.5s ease; }
    #overlay {
      position: absolute; top: 0; left: 0; width: 100%; color: white;
      font-family: sans-serif; padding: 1rem; background: rgba(0,0,0,0.5);
    }
  </style>
</head>
<body>
  <img id="slideshow-image" src="" alt="Slideshow Image">
  <script>
    const imageIds = <%= JSON.stringify(imageIds) %>;
    const baseUrl = '/api/v1/image/view/';
    const images = imageIds.map(id => `${baseUrl}${id}`);

    let index = 0;
    let paused = false;
    let interval = <%= interval %>;
    let timer;

    const img = document.getElementById('slideshow-image');

    function showImage() {
      img.style.opacity = 0;
      setTimeout(() => {
        img.src = images[index];
        img.style.opacity = 1;
      }, 100);
    }

    function nextImage() {
      index = (index + 1) % images.length;
      showImage();
    }

    function prevImage() {
      index = (index - 1 + images.length) % images.length;
      showImage();
    }

    function startLoop() {
      timer = setInterval(() => {
        if (!paused) nextImage();
      }, interval);
    }

    function stopLoop() {
      clearInterval(timer);
    }

    document.addEventListener('keydown', (e) => {
      switch (e.key) {
        case ' ': paused = !paused; break;
        case 'Escape': window.close(); break;
        case 'ArrowRight': nextImage(); break;
        case 'ArrowLeft': prevImage(); break;
      }
    });

    showImage();
    startLoop();
  </script>
</body>
</html>