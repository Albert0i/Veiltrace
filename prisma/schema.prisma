generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model imagetrace {
  id          Int                        @id @default(autoincrement())
  imageName   String
  fullPath    String                     @unique(map: "uniq_image_fullpath")
  fileFormat  String
  fileSize    Int
  meta        String                     @db.Text
  description String                     @db.Text
  embedding   Unsupported("vector(768)")
  miniature   Bytes?
  visited     Int                        @default(0)
  updatedAt   String?
  indexedAt   String
  createdAt   String
  updateIdent Int                        @default(0)
  vistatrace  vistatrace[]

  @@index([createdAt], map: "idx_image_created")
  @@index([embedding], map: "idx_image_embedding")
  @@index([fileFormat], map: "idx_image_format")
  @@index([visited], map: "idx_image_visited")
  @@fulltext([description], map: "fts_image_description")
}

model vistatrace {
  id          Int             @id @default(autoincrement())
  imageId     Int
  type        vistatrace_type @default(view)
  createdAt   String
  updateIdent Int             @default(0)
  imagetrace  imagetrace      @relation(fields: [imageId], references: [id], onDelete: Cascade, map: "VistaTrace_imageId_fkey")

  @@index([imageId], map: "idx_vista_image_ref")
}

model archivetrace {
  id          Int     @id @default(autoincrement())
  avatarId    Int     @default(0)
  title       String
  description String? @db.Text
  imageIds    String? @db.LongText
  updatedAt   String?
  createdAt   String
  updateIdent Int     @default(0)
}

enum vistatrace_type {
  view
  export
}
